# 圖表功能說明

## 概述

LLM壓力測試工具提供了兩套不同的圖表系統，分別對應測試一（基礎壓力測試）和測試二（多用戶並發測試）。圖表會根據執行的測試類型自動切換顯示。

## 測試一 - 基礎壓力測試圖表

### 📊 回應時間分布直方圖
- **用途**: 顯示所有請求的回應時間分布情況
- **X軸**: 回應時間區間（秒）
- **Y軸**: 該時間區間內的請求數量
- **分析**: 幫助識別性能瓶頸和異常值

### 🥧 請求成功率餅圖
- **用途**: 視覺化顯示成功和失敗請求的比例
- **綠色**: 成功請求
- **紅色**: 失敗請求
- **分析**: 快速評估系統穩定性

### 📈 回應時間趨勢圖
- **用途**: 顯示測試過程中回應時間的變化趨勢
- **X軸**: 請求序號或時間
- **Y軸**: 回應時間（秒）
- **分析**: 識別性能衰減或改善趨勢

### 📦 回應時間統計箱線圖
- **用途**: 顯示回應時間的統計分布
- **包含**: 最小值、第一四分位數、中位數、第三四分位數、最大值
- **分析**: 深入了解回應時間的分布特徵

## 測試二 - 多用戶並發測試圖表

### 🚀 TPM (每分鐘Token數) 趨勢圖
- **用途**: 顯示測試過程中TPM的變化趨勢
- **X軸**: 時間（分:秒）
- **Y軸**: TPM值（tokens/分鐘）
- **特色**: 綠色線條，清晰顯示吞吐量變化
- **分析**: 評估模型的實際處理能力

### 👥 各用戶查詢統計圖
- **用途**: 比較不同用戶的查詢數量和Token數量
- **左Y軸**: 查詢數量（藍色柱狀圖）
- **右Y軸**: Token數量（橙色柱狀圖）
- **X軸**: 用戶ID
- **分析**: 確保負載均勻分布

### ✅ 各用戶成功率圖
- **用途**: 顯示每個用戶的查詢成功率
- **顏色編碼**:
  - 綠色: 100% 成功率
  - 黃色: 80-99% 成功率
  - 紅色: <80% 成功率
- **分析**: 識別特定用戶的問題

### 🎯 響應時間 vs Token數量散點圖
- **用途**: 分析響應時間與Token數量的關係
- **X軸**: 響應時間（秒）
- **Y軸**: Token數量
- **顏色**: 用戶ID（彩色編碼）
- **分析**: 發現性能模式和異常點

## 圖表切換機制

### 自動切換
- 執行測試一時，自動顯示基礎壓力測試圖表
- 執行測試二時，自動顯示多用戶並發測試圖表
- 圖表標題會相應更新

### 手動控制
圖表系統通過JavaScript函數控制：
- `showTest1Charts()`: 顯示測試一圖表
- `showTest2Charts()`: 顯示測試二圖表

## API端點

### 測試一圖表
```
GET /api/test_charts/<test_id>
```
返回測試一的所有圖表數據

### 測試二圖表
```
GET /api/multi_user_test_charts/<test_id>
```
返回測試二的所有圖表數據

## 圖表技術

### 使用的庫
- **Plotly.js**: 主要圖表渲染引擎
- **Bootstrap 5**: 響應式佈局
- **自定義CSS**: 美化和主題

### 特性
- **響應式設計**: 自動適應不同螢幕尺寸
- **互動功能**: 支援縮放、平移、懸停提示
- **實時更新**: 測試完成後自動載入圖表
- **美觀設計**: 使用專業的顏色方案和佈局

## 使用建議

### 測試一分析流程
1. 查看成功率餅圖 → 評估整體穩定性
2. 觀察回應時間趨勢 → 識別性能變化
3. 分析回應時間分布 → 找出性能瓶頸
4. 檢查箱線圖 → 深入了解統計特徵

### 測試二分析流程
1. 查看TPM趨勢圖 → 評估吞吐量性能
2. 檢查用戶分布圖 → 確認負載均勻性
3. 觀察成功率圖 → 識別問題用戶
4. 分析散點圖 → 發現性能模式

### 性能優化指導
- **TPM過低**: 考慮增加並發數或優化模型
- **成功率不均**: 檢查用戶配置或網路問題
- **響應時間波動大**: 可能需要調整查詢間隔
- **Token數量差異大**: 檢查提示詞分配邏輯

## 故障排除

### 圖表不顯示
1. 檢查測試是否完成
2. 確認瀏覽器支援JavaScript
3. 查看瀏覽器控制台錯誤
4. 驗證API端點是否正常

### 數據異常
1. 確認測試配置正確
2. 檢查Ollama服務器狀態
3. 驗證模型是否正常載入
4. 查看詳細日誌信息

### 性能問題
1. 減少並發數量
2. 增加查詢間隔
3. 選擇較小的模型
4. 檢查系統資源使用

## 未來增強

### 計劃功能
- 圖表匯出功能（PNG、PDF）
- 歷史測試結果比較
- 自定義圖表配置
- 更多統計指標
- 實時圖表更新

### 自定義選項
- 圖表主題切換
- 顏色方案選擇
- 圖表大小調整
- 數據過濾選項

## 技術細節

### 圖表生成流程
1. 測試完成後收集數據
2. 後端處理和統計計算
3. 生成Plotly圖表配置
4. 前端接收並渲染圖表
5. 應用響應式佈局

### 數據格式
所有圖表數據都以JSON格式傳輸，包含：
- 圖表數據（data）
- 佈局配置（layout）
- 互動選項（config）

### 瀏覽器兼容性
- Chrome 60+
- Firefox 55+
- Safari 12+
- Edge 79+
